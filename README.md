# Phishing-Attempt-with-zeek

## Objective
The goal of this project is to analyze network traffic using Zeek to identify suspicious activities and malicious files associated with a potential phishing attack. By reviewing the generated logs, the aim is to understand the connections and resources involved, as well as to reinforce security measures on the network to prevent future threats.

## Steps

1-  I use the "ls" command to view the files in the phishing folder. Here I have several important files, such as 'phishing.pcap', which is the network traffic capture file, and other '.log' files generated by Zeek after processing the '.pcap.'

 I run "zeek -C -r phishing.pcap." This command executes Zeek to analyze the capture file 'phishing.pcap.' The '-C' option tells Zeek to ignore checksum errors in the packets, which is useful if some are damaged. The '-r' option allows Zeek to read the data from the '.pcap' file instead of doing it in real time, generating several log files with detailed information about the network traffic.
 I use the "cat conn.log" command to view the contents of this file, which Zeek has generated to log all connections detected in the analyzed traffic.

Interpreting the fields of conn.log:

/ts: Timestamp of the connection.

/uid: Unique identifier assigned to each connection.

/id.orig_h and id.orig_p: Source IP and port.

/id.resp_h and id.resp_p: Destination IP and port.

/proto: Protocol used (UDP or TCP).

/service: Detected service (DNS, HTTP, etc.).

/duration: Total duration of the connection.

/orig_bytes and resp_bytes: Bytes sent by the origin host and response.

/conn_state: State of the connection.

![Screenshot 2024-10-29 135652](https://github.com/user-attachments/assets/c104b855-d40e-44e6-84e4-345912586862)

2-  I use cat conn.log | zeek-cut id.orig_h | sort | uniq to display the unique source IP addresses recorded in the conn.log file, making it easier to identify unique hosts on the network.

![Screenshot 2024-10-29 140718](https://github.com/user-attachments/assets/5473bb56-1e29-4057-be6c-3f208a41e5b4)

3-  I use the command cat http.log to see the contents of this file, which Zeek has generated to log all detected HTTP interactions.

Interpreting the Fields of http.log:

ts: Timestamp of the transaction.

uid: Unique identifier for the session.

id.orig_h and id.orig_p: Source IP and port of the request.

id.resp_h and id.resp_p: IP and port of the responding server.

method: HTTP method used (GET, POST).

host: Hostname to which the request was sent.

uri: URI of the requested resource.

response_code: HTTP status code returned (e.g., 200 OK).

user_agent: Information about the clientâ€™s browser and operating system.

You can observe that smart-fax.com is the domain from which the malicious files were downloaded.

![Screenshot 2024-10-29 141306](https://github.com/user-attachments/assets/10621f7d-9a78-47f4-9b37-7af8d6e15635)

4-  Next, we enter the domain smart-fax.com into VirusTotal and can observe that it is flagged as malicious. This indicates that the domain is linked to harmful activities, such as the distribution of malware or phishing, reinforcing the importance of continuous vigilance to protect network security.

![Screenshot 2024-10-29 143646](https://github.com/user-attachments/assets/f0d6901a-490e-4514-a326-0ef0b99460ee)

5- I use the command cat files.log | head -n 10 to display the first 10 lines of the files.log file, which contains information about the files detected by Zeek.

Interpreting the Output:

MD5 and SHA1: Hashes that uniquely identify the files, crucial for detecting whether they are malicious.

File Identification: Allows for verifying if the files are related to suspicious activities.

![Screenshot 2024-10-29 144532](https://github.com/user-attachments/assets/51afec27-c346-4da9-ab1e-f433ae0a1c9e)

6-  Then i input the SHA1 hash into VirusTotal and can see that it is malicious. My goal is to identify the type of file associated with the malicious document, which is crucial for determining the risk and how it may affect the systems.

![Screenshot 2024-10-29 145205](https://github.com/user-attachments/assets/08373d17-cef3-4d20-bbfe-de8d99c0cded)

7- I use the command cat files.log | zeek-cut type filename sha1 to filter and view specific information about the files recorded by Zeek.

Interpreting the Output: The output shows:

type: Indicates the content type of the file.

text/plain: Plain text file.

application/msword: Microsoft Word document.

application/x-dosexec: Windows executable file (potentially malicious).

filename: Name of the file associated with the record.

sha1: SHA1 hash of the file, useful for searching in malware databases or correlating with other records.

![Screenshot 2024-10-29 150455](https://github.com/user-attachments/assets/f29703e2-345e-4291-9465-4e037561ef75)

8- Next, we input one of the SHA values that appear and can see which .exe file is related to that malicious SHA. This is important for identifying the specific file associated with it, which is essential for understanding its potential threat.

![Screenshot 2024-10-29 150542](https://github.com/user-attachments/assets/14b8f1ec-d8de-4f6b-94f8-74e735092ca2)

9- With VirusTotal, we can see in the Network Connections section the name of the contacted domain. This is relevant for identifying malicious activities and correlating incidents. Knowing which domain has been contacted allows me to implement preventive measures, such as blocking the domain on the network and alerting users about potential risks.

![Screenshot 2024-10-29 152120](https://github.com/user-attachments/assets/968331bc-22c9-4273-a719-bcee9833664d)

#Conclusion

The analysis of network traffic using Zeek has allowed for the identification of suspicious connections and malicious files in the phishing.pcap file. Through logs such as conn.log and http.log, key information, such as IP addresses and HTTP activities, has been tracked.

The verification of hashes (MD5 and SHA1) on VirusTotal has revealed malicious files and linked the domain smart-fax.com to dangerous activities. This process underscores the importance of proactive vigilance to prevent phishing and malware attacks.





